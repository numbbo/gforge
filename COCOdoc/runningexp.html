<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Running Experiments with COCO &mdash; COCO 15.03
 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '15.03
',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="COCO 15.03
 documentation" href="index.html" />
    <link rel="next" title="Post-Processing with COCO" href="postprocessing.html" />
    <link rel="prev" title="Black-Box Optimization Benchmarking Procedure" href="bbo_experiment.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="postprocessing.html" title="Post-Processing with COCO"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="bbo_experiment.html" title="Black-Box Optimization Benchmarking Procedure"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">COCO 15.03
 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="running-experiments-with-coco">
<h1>Running Experiments with COCO<a class="headerlink" href="#running-experiments-with-coco" title="Permalink to this headline">¶</a></h1>
<p>COCO provides an interface for running experiments. This interface <code class="xref c c-func docutils literal"><span class="pre">fgeneric</span></code> has been
ported in different languages:</p>
<ul class="simple">
<li>in Python, Matlab/GNU Octave, C/C++, R and Java,</li>
</ul>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#exampleexperiment-and-exampletiming" id="id1"><code class="file docutils literal"><span class="pre">exampleexperiment</span></code> and <code class="file docutils literal"><span class="pre">exampletiming</span></code></a><ul>
<li><a class="reference internal" href="#matlab-gnu-octave" id="id2">Matlab/GNU Octave</a></li>
<li><a class="reference internal" href="#c-c" id="id3">C/C++</a></li>
<li><a class="reference internal" href="#r" id="id4">R</a><ul>
<li><a class="reference internal" href="#quick-installation" id="id5">Quick Installation</a></li>
<li><a class="reference internal" href="#detailed-installation" id="id6">Detailed Installation</a></li>
<li><a class="reference internal" href="#simple-experiment" id="id7">Simple experiment</a></li>
<li><a class="reference internal" href="#low-level-interface" id="id8">Low-level interface</a></li>
</ul>
</li>
<li><a class="reference internal" href="#python" id="id9">Python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#testing-new-functions" id="id10">Testing New Functions</a><ul>
<li><a class="reference internal" href="#testing-functions-with-parameter" id="id11">Testing Functions with Parameter</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="exampleexperiment-and-exampletiming">
<h2><a class="toc-backref" href="#id1"><code class="file docutils literal"><span class="pre">exampleexperiment</span></code> and <code class="file docutils literal"><span class="pre">exampletiming</span></code></a><a class="headerlink" href="#exampleexperiment-and-exampletiming" title="Permalink to this headline">¶</a></h2>
<p>In each language, two example scripts are provided. Below are the example
scripts in Matlab/GNU Octave:</p>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">exampleexperiment</span></code> runs an experiment on one testbed,</li>
</ul>
<div class="highlight-matlab"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">% runs an entire experiment for benchmarking MY_OPTIMIZER</span>
<span class="c">% on the noise-free testbed. fgeneric.m and benchmarks.m</span>
<span class="c">% must be in the path of Matlab/Octave</span>
<span class="c">% CAPITALIZATION indicates code adaptations to be made</span>

<span class="n">addpath</span><span class="p">(</span><span class="s">&#39;PUT_PATH_TO_BBOB/matlab&#39;</span><span class="p">);</span>  <span class="c">% should point to fgeneric.m etc.</span>
<span class="n">datapath</span> <span class="p">=</span> <span class="s">&#39;PUT_MY_BBOB_DATA_PATH&#39;</span><span class="p">;</span>  <span class="c">% different folder for each experiment</span>
<span class="c">% opt.inputFormat = &#39;row&#39;;</span>
<span class="n">opt</span><span class="p">.</span><span class="n">algName</span> <span class="p">=</span> <span class="s">&#39;PUT ALGORITHM NAME&#39;</span><span class="p">;</span>
<span class="n">opt</span><span class="p">.</span><span class="n">comments</span> <span class="p">=</span> <span class="s">&#39;PUT MORE DETAILED INFORMATION, PARAMETER SETTINGS ETC&#39;</span><span class="p">;</span>
<span class="n">maxfunevals</span> <span class="p">=</span> <span class="s">&#39;10 * dim&#39;</span><span class="p">;</span> <span class="c">% 10*dim is a short test-experiment taking a few minutes </span>
                          <span class="c">% INCREMENT maxfunevals successively to larger value(s)</span>
<span class="n">minfunevals</span> <span class="p">=</span> <span class="s">&#39;dim + 2&#39;</span><span class="p">;</span>  <span class="c">% PUT MINIMAL SENSIBLE NUMBER OF EVALUATIONS for a restart</span>
<span class="n">maxrestarts</span> <span class="p">=</span> <span class="mf">1e4</span><span class="p">;</span>        <span class="c">% SET to zero for an entirely deterministic algorithm</span>

<span class="n">dimensions</span> <span class="p">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">];</span>  <span class="c">% small dimensions first, for CPU reasons</span>
<span class="k">function</span>s <span class="p">=</span><span class="w"> </span><span class="nf">benchmarks(&#39;FunctionIndices&#39;);  % or benchmarksnoisy</span><span class="p">(</span>...<span class="p">)</span><span class="w"></span>
<span class="n">instances</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">41</span><span class="p">:</span><span class="mi">50</span><span class="p">];</span>  <span class="c">% 15 function instances</span>

<span class="n">more</span> <span class="n">off</span><span class="p">;</span>  <span class="c">% in octave pagination is on by default</span>

<span class="n">t0</span> <span class="p">=</span> <span class="n">clock</span><span class="p">;</span>
<span class="nb">rand</span><span class="p">(</span><span class="s">&#39;state&#39;</span><span class="p">,</span> <span class="n">sum</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">t0</span><span class="p">));</span>

<span class="k">for</span> <span class="n">dim</span> <span class="p">=</span> <span class="n">dimensions</span>
  <span class="k">for</span> <span class="n">ifun</span> <span class="p">=</span> <span class="n">functions</span>
    <span class="k">for</span> <span class="n">iinstance</span> <span class="p">=</span> <span class="n">instances</span>
      <span class="n">fgeneric</span><span class="p">(</span><span class="s">&#39;initialize&#39;</span><span class="p">,</span> <span class="n">ifun</span><span class="p">,</span> <span class="n">iinstance</span><span class="p">,</span> <span class="n">datapath</span><span class="p">,</span> <span class="n">opt</span><span class="p">);</span> 

      <span class="c">% independent restarts until maxfunevals or ftarget is reached</span>
      <span class="k">for</span> <span class="n">restarts</span> <span class="p">=</span> <span class="mi">0</span><span class="p">:</span><span class="n">maxrestarts</span>
        <span class="k">if</span> <span class="n">restarts</span> <span class="o">&gt;</span> <span class="mi">0</span>  <span class="c">% write additional restarted info</span>
          <span class="n">fgeneric</span><span class="p">(</span><span class="s">&#39;restart&#39;</span><span class="p">,</span> <span class="s">&#39;independent restart&#39;</span><span class="p">)</span>
        <span class="k">end</span>
        <span class="n">MY_OPTIMIZER</span><span class="p">(</span><span class="s">&#39;fgeneric&#39;</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">fgeneric</span><span class="p">(</span><span class="s">&#39;ftarget&#39;</span><span class="p">),</span> <span class="c">...</span>
                     <span class="n">eval</span><span class="p">(</span><span class="n">maxfunevals</span><span class="p">)</span> <span class="o">-</span> <span class="n">fgeneric</span><span class="p">(</span><span class="s">&#39;evaluations&#39;</span><span class="p">));</span>
        <span class="k">if</span> <span class="n">fgeneric</span><span class="p">(</span><span class="s">&#39;fbest&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">fgeneric</span><span class="p">(</span><span class="s">&#39;ftarget&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="c">...</span>
           <span class="n">fgeneric</span><span class="p">(</span><span class="s">&#39;evaluations&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">eval</span><span class="p">(</span><span class="n">minfunevals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">eval</span><span class="p">(</span><span class="n">maxfunevals</span><span class="p">)</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="k">end</span>  
      <span class="k">end</span>

      <span class="nb">disp</span><span class="p">(</span><span class="n">sprintf</span><span class="p">([</span><span class="s">&#39;  f%d in %d-D, instance %d: FEs=%d with %d restarts,&#39;</span> <span class="c">...</span>
                    <span class="s">&#39; fbest-ftarget=%.4e, elapsed time [h]: %.2f&#39;</span><span class="p">],</span> <span class="c">...</span>
                   <span class="n">ifun</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">iinstance</span><span class="p">,</span> <span class="c">...</span>
                   <span class="n">fgeneric</span><span class="p">(</span><span class="s">&#39;evaluations&#39;</span><span class="p">),</span> <span class="c">...</span>
                   <span class="n">restarts</span><span class="p">,</span> <span class="c">...</span>
                   <span class="n">fgeneric</span><span class="p">(</span><span class="s">&#39;fbest&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">fgeneric</span><span class="p">(</span><span class="s">&#39;ftarget&#39;</span><span class="p">),</span> <span class="c">...</span>
                   <span class="n">etime</span><span class="p">(</span><span class="n">clock</span><span class="p">,</span> <span class="n">t0</span><span class="p">)</span><span class="o">/</span><span class="mi">60</span><span class="o">/</span><span class="mi">60</span><span class="p">));</span>

      <span class="n">fgeneric</span><span class="p">(</span><span class="s">&#39;finalize&#39;</span><span class="p">);</span>
    <span class="k">end</span>
    <span class="nb">disp</span><span class="p">([</span><span class="s">&#39;      date and time: &#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">clock</span><span class="p">,</span> <span class="s">&#39; %.0f&#39;</span><span class="p">)]);</span>
  <span class="k">end</span>
  <span class="nb">disp</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;---- dimension %d-D done ----&#39;</span><span class="p">,</span> <span class="n">dim</span><span class="p">));</span>
<span class="k">end</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li><code class="file docutils literal"><span class="pre">exampletiming</span></code> runs the CPU-timing experiment.</li>
</ul>
<div class="highlight-matlab"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">% runs the timing experiment for MY_OPTIMIZER. fgeneric.m</span>
<span class="c">% and benchmarks.m must be in the path of MATLAB/Octave</span>

<span class="n">addpath</span><span class="p">(</span><span class="s">&#39;PUT_PATH_TO_BBOB/matlab&#39;</span><span class="p">);</span>  <span class="c">% should point to fgeneric.m etc.</span>

<span class="n">more</span> <span class="n">off</span><span class="p">;</span>  <span class="c">% in octave pagination is on by default</span>

<span class="n">timings</span> <span class="p">=</span> <span class="p">[];</span>
<span class="n">runs</span> <span class="p">=</span> <span class="p">[];</span>
<span class="n">dims</span> <span class="p">=</span> <span class="p">[];</span>
<span class="k">for</span> <span class="n">dim</span> <span class="p">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">]</span>
  <span class="n">nbrun</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">ftarget</span> <span class="p">=</span> <span class="n">fgeneric</span><span class="p">(</span><span class="s">&#39;initialize&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;tmp&#39;</span><span class="p">);</span>
  <span class="n">tic</span><span class="p">;</span>
  <span class="k">while</span> <span class="n">toc</span> <span class="o">&lt;</span> <span class="mi">30</span>  <span class="c">% at least 30 seconds</span>
    <span class="n">MY_OPTIMIZER</span><span class="p">(@</span><span class="n">fgeneric</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">ftarget</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">);</span>  <span class="c">% adjust maxfunevals</span>
    <span class="n">nbrun</span> <span class="p">=</span> <span class="n">nbrun</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">end</span>  <span class="c">% while</span>
  <span class="n">timings</span><span class="p">(</span><span class="k">end</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">toc</span> <span class="o">/</span> <span class="n">fgeneric</span><span class="p">(</span><span class="s">&#39;evaluations&#39;</span><span class="p">);</span>
  <span class="n">dims</span><span class="p">(</span><span class="k">end</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">dim</span><span class="p">;</span>    <span class="c">% not really needed</span>
  <span class="n">runs</span><span class="p">(</span><span class="k">end</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">nbrun</span><span class="p">;</span>  <span class="c">% not really needed</span>
  <span class="n">fgeneric</span><span class="p">(</span><span class="s">&#39;finalize&#39;</span><span class="p">);</span>
  <span class="nb">disp</span><span class="p">([[</span><span class="s">&#39;Dimensions:&#39;</span> <span class="n">sprintf</span><span class="p">(</span><span class="s">&#39; %11d &#39;</span><span class="p">,</span> <span class="n">dims</span><span class="p">)];</span> <span class="c">...</span>
        <span class="p">[</span><span class="s">&#39;      runs:&#39;</span> <span class="n">sprintf</span><span class="p">(</span><span class="s">&#39; %11d &#39;</span><span class="p">,</span> <span class="n">runs</span><span class="p">)];</span> <span class="c">...</span>
        <span class="p">[</span><span class="s">&#39; times [s]:&#39;</span> <span class="n">sprintf</span><span class="p">(</span><span class="s">&#39; %11.1e &#39;</span><span class="p">,</span> <span class="n">timings</span><span class="p">)]]);</span>
<span class="k">end</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="matlab-gnu-octave">
<h3><a class="toc-backref" href="#id2">Matlab/GNU Octave</a><a class="headerlink" href="#matlab-gnu-octave" title="Permalink to this headline">¶</a></h3>
<p>The above example scripts run a complete experiment. The entire interface
for running experiments is defined via the function <code class="file docutils literal"><span class="pre">fgeneric.m</span></code>.
<a class="reference internal" href="fgeneric.html#module-fgeneric" title="fgeneric"><code class="xref py py-func docutils literal"><span class="pre">fgeneric</span></code></a> is <em>initialized</em> with a function number, instance number and
output data path. <a class="reference internal" href="fgeneric.html#module-fgeneric" title="fgeneric"><code class="xref py py-func docutils literal"><span class="pre">fgeneric</span></code></a> can then be called to evaluate the test function.
The end of a run or trial is signaled by calling <a class="reference internal" href="fgeneric.html#module-fgeneric" title="fgeneric"><code class="xref py py-func docutils literal"><span class="pre">fgeneric</span></code></a> with the &#8216;finalize&#8217;
keyword.</p>
</div>
<div class="section" id="c-c">
<h3><a class="toc-backref" href="#id3">C/C++</a><a class="headerlink" href="#c-c" title="Permalink to this headline">¶</a></h3>
<p>The interface for running experiments relies on functions such as
<code class="xref c c-func docutils literal"><span class="pre">fgeneric_initialize</span></code>, <code class="xref c c-func docutils literal"><span class="pre">fgeneric_finalize</span></code>, <code class="xref c c-func docutils literal"><span class="pre">fgeneric_ftarget</span></code>.
The evaluation function is <code class="xref c c-func docutils literal"><span class="pre">fgeneric_evaluate</span></code> for a
single vector or <code class="xref c c-func docutils literal"><span class="pre">fgeneric_evaluate_vector</span></code>
for an array of vectors as input.</p>
<p>A specific folder structure is needed for running an experiment. This folder
structure can be obtained by un-tarring the archive <code class="file docutils literal"><span class="pre">createfolders.tar.gz</span></code>
and renaming the output folder or alternatively by executing the Python script
<code class="file docutils literal"><span class="pre">createfolders.py</span></code> before executing any experiment program. Make sure
<code class="file docutils literal"><span class="pre">createfolders.py</span></code> is in your current working directory and from the
command-line simply execute:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>python createfolders.py FOLDERNAME
FOLDERNAME was created.
</pre></div>
</div>
<p>The code provided can be compiled in C or C++.</p>
</div>
<div class="section" id="r">
<h3><a class="toc-backref" href="#id4">R</a><a class="headerlink" href="#r" title="Permalink to this headline">¶</a></h3>
<div class="section" id="quick-installation">
<h4><a class="toc-backref" href="#id5">Quick Installation</a><a class="headerlink" href="#quick-installation" title="Permalink to this headline">¶</a></h4>
<p>Run the following commands in your R session:</p>
<div class="highlight-r"><div class="highlight"><pre>install.packages<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;BBmisc&quot;</span><span class="p">,</span> <span class="s">&quot;stringr&quot;</span><span class="p">),</span>
                 repos<span class="o">=</span><span class="s">&quot;http://cran.at.r-project.org&quot;</span><span class="p">)</span>
fn <span class="o">&lt;-</span> <span class="kp">file.path</span><span class="p">(</span><span class="kp">tempdir</span><span class="p">(),</span> <span class="s">&quot;bbob_current.tar.gz&quot;</span><span class="p">)</span>
download.file<span class="p">(</span><span class="s">&quot;http://coco.lri.fr/downloads/download15.03/bbobr.tar.gz&quot;</span><span class="p">,</span>
              destfile<span class="o">=</span>fn<span class="p">)</span>
install.packages<span class="p">(</span>fn<span class="p">,</span> repos<span class="o">=</span><span class="kc">NULL</span><span class="p">)</span>
<span class="kp">file.remove</span><span class="p">(</span>fn<span class="p">)</span>
</pre></div>
</div>
<p>You should now be able to load the package by running</p>
<div class="highlight-r"><div class="highlight"><pre><span class="kn">library</span><span class="p">(</span><span class="s">&quot;bbob&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If all went well, you can skip down to the next section. Otherwise
consulte the detailed instructions which follow.</p>
</div>
<div class="section" id="detailed-installation">
<h4><a class="toc-backref" href="#id6">Detailed Installation</a><a class="headerlink" href="#detailed-installation" title="Permalink to this headline">¶</a></h4>
<p>Before you start, install the required dependencies. At the R prompt
enter</p>
<div class="highlight-r"><div class="highlight"><pre>install.packages<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;BBmisc&quot;</span><span class="p">,</span> <span class="s">&quot;stringr&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>This should download and install the two packages. Now download the
current BBOB R source package and save it somewhere on your hard
drive. The most up-to-date version is always available <a class="reference external" href="http://coco.lri.fr/downloads/download15.03/bbobr.tar.gz">here</a>, but
there should also be a stable version available on the <a class="reference external" href="http://coco.gforge.inria.fr/doku.php?id=bbob-2012-downloads">COCO website</a>. Now
it&#8217;s time to install the package. In R, run the following command:</p>
<div class="highlight-r"><div class="highlight"><pre>install.packages<span class="p">(</span><span class="s">&quot;/path/to/bbob_current.tar.gz&quot;</span><span class="p">,</span> repos<span class="o">=</span><span class="kc">NULL</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that you will have to adjust the path and possibly the filename
to match the location where you stored the downloaded package on your
hard drive. On Windows you will also need to have the <a class="reference external" href="http://cran.r-project.org/bin/windows/Rtools/">Rtools</a>
installed for this to work since the package contains C code. If you
have any problems with this step, do not hesitate to contact <a class="reference external" href="mailto:olafm&#37;&#52;&#48;p-value&#46;net">me</a> for
assistance.</p>
<p>After completing the above steps, you should be able to load the
package in R</p>
<div class="highlight-r"><div class="highlight"><pre><span class="kn">library</span><span class="p">(</span><span class="s">&quot;bbob&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The help page for the <cite>bbo_benchmark</cite> function should get you started
if you do not want to continue reading this introduction.</p>
<div class="highlight-R"><div class="highlight"><pre><span class="o">?</span>bbo_benchmark
</pre></div>
</div>
</div>
<div class="section" id="simple-experiment">
<h4><a class="toc-backref" href="#id7">Simple experiment</a><a class="headerlink" href="#simple-experiment" title="Permalink to this headline">¶</a></h4>
<p>If you already have an optimizer ready to go in R and all you want to
do is produce a BBOB dataset for post-processing, then this section
will walk you through the required steps. We will use the high-level
interface <cite>bbo_benchmark</cite> in this example. If you want to parallelize
your optimization runs, need to perform complex initializations or
just want full control, skip down to the next section for a brief tour
of the low-level interface.</p>
<p>In this example we will use the L-BFGS-B optimizer included in base
R. You will need to adapt parts of the code to suit your
optimizer. The first step is to wrap your optimization algorithm in a
function with the following signature</p>
<div class="highlight-r"><div class="highlight"><pre><span class="kr">function</span><span class="p">(</span>par<span class="p">,</span> fun<span class="p">,</span> lower<span class="p">,</span> upper<span class="p">,</span> max_eval<span class="p">)</span>
</pre></div>
</div>
<p>where <cite>par</cite> will be a numeric vector with the starting point for the
optimization, <cite>fun</cite> is the function to be minimized, <cite>lower</cite> and
<cite>upper</cite> are the bounds of the box constraints and <cite>max_eval</cite> is the
number of function evaluations left in the allocated budget. What
these five parameters mean is best conveyed by an example. Here we
wrap the <cite>optim</cite> function included in base R</p>
<div class="highlight-r"><div class="highlight"><pre>my_optimizer <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>par<span class="p">,</span> fun<span class="p">,</span> lower<span class="p">,</span> upper<span class="p">,</span> max_eval<span class="p">)</span> <span class="p">{</span>
  optim<span class="p">(</span>par<span class="p">,</span> fun<span class="p">,</span> method<span class="o">=</span><span class="s">&quot;L-BFGS-B&quot;</span><span class="p">,</span>
        lower<span class="o">=</span>lower<span class="p">,</span> upper<span class="o">=</span>upper<span class="p">,</span> control<span class="o">=</span><span class="kt">list</span><span class="p">(</span>maxit<span class="o">=</span>max_eval<span class="p">))</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If your algorithm does not have the notion of an initial parameter
setting, you can safely ignore the <cite>par</cite> parameter in your
implementation. You might also notice, that we do not strictly adhere
to the <cite>max_eval</cite> limit because the number of iterations is generally
not equal to the number of function evaluations for L-BFGS-B. This is
OK. <cite>max_eval</cite> is only a hint to the optimizer how much effort it
should put into optimizing the function.</p>
<p>Should your algorithm perform restarts internally it is possible to
log these using the <cite>bbob_log_restart</cite> function. The function takes
exactly one argument, a string describing the reason for the restart.</p>
<p>We are now ready to run our experiment. This is done by calling the
<cite>bbo_benchmark</cite> function</p>
<div class="highlight-r"><div class="highlight"><pre>bbo_benchmark<span class="p">(</span>my_optimizer<span class="p">,</span> <span class="s">&quot;l-bfgs-b&quot;</span><span class="p">,</span> <span class="s">&quot;optim_l-bfgs-b&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>which will perform the BBOB experiments (caution, may take many
hours). The first argument passed to <cite>bbo_benchmark</cite> is our
optimization wrapper from the previous step. Make sure that it has the
correct function signature! Next we supply the so called <em>algorithm
id</em>. This is a short descriptive name for our optimization
algorithm. Ideally it should include the package name and version
which contains the algorithm. So for for <cite>genoud</cite> from the <cite>rgenoud</cite>
package, we might use <cite>rgenoud::genoud (5.7-3)</cite> as the algorithm
id. The last required argument is the name of the base directory where
the result files will be stored. Again, it is a good idea to include
the algorithm name in the directory name. If no other arguments are
given, this runs a complete BBO benchmark on the noiseless test
functions. This includes all instances (1-5 and 21-30), all dimensions
(2, 3, 5, 10, 20, 40). If you do not want to include runs in 40
dimensions or want to use different instances you can change the
defaults using the <cite>dimensions</cite> and <cite>instances</cite> arguments to
<cite>bbo_benchmark</cite>. For details, see the manual page for <cite>bbo_benchmark</cite>.</p>
<p>If no other budget is specified, <cite>bbo_benchmark</cite> will perform random
independent restarts of your algorithm until the desired target
precision (1e-8) is reached or the default budget of 10000000 function
evaluations is exhausted. If you want to reduce the budget, you can by
specifiying it as the <cite>budget</cite> argument to <cite>bbo_benchmark</cite>.</p>
<p>To run the required timing experiment, execute the following code:</p>
<div class="highlight-r"><div class="highlight"><pre>bbo_timing<span class="p">(</span>my_optimizer<span class="p">)</span>
</pre></div>
</div>
<p>It will return a data frame with the relevant timing information.</p>
</div>
<div class="section" id="low-level-interface">
<h4><a class="toc-backref" href="#id8">Low-level interface</a><a class="headerlink" href="#low-level-interface" title="Permalink to this headline">¶</a></h4>
<p>Will follow soon.</p>
</div>
</div>
<div class="section" id="python">
<h3><a class="toc-backref" href="#id9">Python</a><a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h3>
<p>The interface for running an experiment is <a class="reference internal" href="fgeneric.html#module-fgeneric" title="fgeneric"><code class="xref py py-mod docutils literal"><span class="pre">fgeneric</span></code></a> which is used
within <code class="file docutils literal"><span class="pre">exampleexperiment.py</span></code>:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="sd">&quot;&quot;&quot;Runs an entire experiment for benchmarking PURE_RANDOM_SEARCH on a testbed.</span>

<span class="sd">CAPITALIZATION indicates code adaptations to be made.</span>
<span class="sd">This script as well as files bbobbenchmarks.py and fgeneric.py need to be</span>
<span class="sd">in the current working directory.</span>

<span class="sd">Under unix-like systems: </span>
<span class="sd">    nohup nice python exampleexperiment.py [data_path [dimensions [functions [instances]]]] &gt; output.txt &amp;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span> <span class="c"># in case we want to control what to run via command line args</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">fgeneric</span>
<span class="kn">import</span> <span class="nn">bbobbenchmarks</span>

<span class="n">argv</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="c"># shortcut for input arguments</span>

<span class="n">datapath</span> <span class="o">=</span> <span class="s">&#39;PUT_MY_BBOB_DATA_PATH&#39;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">dimensions</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="nb">eval</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">function_ids</span> <span class="o">=</span> <span class="n">bbobbenchmarks</span><span class="o">.</span><span class="n">nfreeIDs</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="k">else</span> <span class="nb">eval</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>  
<span class="c"># function_ids = bbobbenchmarks.noisyIDs if len(argv) &lt; 3 else eval(argv[2])</span>
<span class="n">instances</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="nb">range</span><span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span> <span class="k">else</span> <span class="nb">eval</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

<span class="n">opts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">algid</span><span class="o">=</span><span class="s">&#39;PUT ALGORITHM NAME&#39;</span><span class="p">,</span>
            <span class="n">comments</span><span class="o">=</span><span class="s">&#39;PUT MORE DETAILED INFORMATION, PARAMETER SETTINGS ETC&#39;</span><span class="p">)</span>
<span class="n">maxfunevals</span> <span class="o">=</span> <span class="s">&#39;10 * dim&#39;</span> <span class="c"># 10*dim is a short test-experiment taking a few minutes </span>
<span class="c"># INCREMENT maxfunevals SUCCESSIVELY to larger value(s)</span>
<span class="n">minfunevals</span> <span class="o">=</span> <span class="s">&#39;dim + 2&#39;</span>  <span class="c"># PUT MINIMAL sensible number of EVALUATIONS before to restart</span>
<span class="n">maxrestarts</span> <span class="o">=</span> <span class="mi">10000</span>      <span class="c"># SET to zero if algorithm is entirely deterministic </span>


<span class="k">def</span> <span class="nf">run_optimizer</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">maxfunevals</span><span class="p">,</span> <span class="n">ftarget</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">Inf</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;start the optimizer, allowing for some preparation. </span>
<span class="sd">    This implementation is an empty template to be filled </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># prepare</span>
    <span class="n">x_start</span> <span class="o">=</span> <span class="mf">8.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span>
    
    <span class="c"># call, REPLACE with optimizer to be tested</span>
    <span class="n">PURE_RANDOM_SEARCH</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x_start</span><span class="p">,</span> <span class="n">maxfunevals</span><span class="p">,</span> <span class="n">ftarget</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">PURE_RANDOM_SEARCH</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">maxfunevals</span><span class="p">,</span> <span class="n">ftarget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;samples new points uniformly randomly in [-5,5]^dim and evaluates</span>
<span class="sd">    them on fun until maxfunevals or ftarget is reached, or until</span>
<span class="sd">    1e8 * dim function evaluations are conducted.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">maxfunevals</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1e8</span> <span class="o">*</span> <span class="n">dim</span><span class="p">,</span> <span class="n">maxfunevals</span><span class="p">)</span>
    <span class="n">popsize</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">maxfunevals</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">fbest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">maxfunevals</span> <span class="o">/</span> <span class="n">popsize</span><span class="p">))):</span>
        <span class="n">xpop</span> <span class="o">=</span> <span class="mf">10.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">popsize</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span> <span class="o">-</span> <span class="mf">5.</span>
        <span class="n">fvalues</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">xpop</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">fvalues</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fbest</span> <span class="o">&gt;</span> <span class="n">fvalues</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]:</span>
            <span class="n">fbest</span> <span class="o">=</span> <span class="n">fvalues</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">xbest</span> <span class="o">=</span> <span class="n">xpop</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">fbest</span> <span class="o">&lt;</span> <span class="n">ftarget</span><span class="p">:</span>  <span class="c"># task achieved </span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="n">xbest</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">t0</span><span class="p">))</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">fgeneric</span><span class="o">.</span><span class="n">LoggingFunction</span><span class="p">(</span><span class="n">datapath</span><span class="p">,</span> <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">dimensions</span><span class="p">:</span>  <span class="c"># small dimensions first, for CPU reasons</span>
    <span class="k">for</span> <span class="n">fun_id</span> <span class="ow">in</span> <span class="n">function_ids</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">iinstance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">setfun</span><span class="p">(</span><span class="o">*</span><span class="n">bbobbenchmarks</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">fun_id</span><span class="p">,</span> <span class="n">iinstance</span><span class="o">=</span><span class="n">iinstance</span><span class="p">))</span>

            <span class="c"># independent restarts until maxfunevals or ftarget is reached</span>
            <span class="k">for</span> <span class="n">restarts</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">maxrestarts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">restarts</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">restart</span><span class="p">(</span><span class="s">&#39;independent restart&#39;</span><span class="p">)</span>  <span class="c"># additional info</span>
                <span class="n">run_optimizer</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">evalfun</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span>  <span class="nb">eval</span><span class="p">(</span><span class="n">maxfunevals</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="o">.</span><span class="n">evaluations</span><span class="p">,</span>
                              <span class="n">f</span><span class="o">.</span><span class="n">ftarget</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">fbest</span> <span class="o">&lt;</span> <span class="n">f</span><span class="o">.</span><span class="n">ftarget</span>
                    <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">evaluations</span> <span class="o">+</span> <span class="nb">eval</span><span class="p">(</span><span class="n">minfunevals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">eval</span><span class="p">(</span><span class="n">maxfunevals</span><span class="p">)):</span>
                    <span class="k">break</span>

            <span class="n">f</span><span class="o">.</span><span class="n">finalizerun</span><span class="p">()</span>

            <span class="k">print</span><span class="p">(</span><span class="s">&#39;  f</span><span class="si">%d</span><span class="s"> in </span><span class="si">%d</span><span class="s">-D, instance </span><span class="si">%d</span><span class="s">: FEs=</span><span class="si">%d</span><span class="s"> with </span><span class="si">%d</span><span class="s"> restarts, &#39;</span>
                  <span class="s">&#39;fbest-ftarget=</span><span class="si">%.4e</span><span class="s">, elapsed time [h]: </span><span class="si">%.2f</span><span class="s">&#39;</span>
                  <span class="o">%</span> <span class="p">(</span><span class="n">fun_id</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">iinstance</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">evaluations</span><span class="p">,</span> <span class="n">restarts</span><span class="p">,</span>
                     <span class="n">f</span><span class="o">.</span><span class="n">fbest</span> <span class="o">-</span> <span class="n">f</span><span class="o">.</span><span class="n">ftarget</span><span class="p">,</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span><span class="o">/</span><span class="mf">60.</span><span class="o">/</span><span class="mf">60.</span><span class="p">))</span>

        <span class="k">print</span> <span class="s">&#39;      date and time: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">())</span>
    <span class="k">print</span> <span class="s">&#39;---- dimension </span><span class="si">%d</span><span class="s">-D done ----&#39;</span> <span class="o">%</span> <span class="n">dim</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="testing-new-functions">
<h2><a class="toc-backref" href="#id10">Testing New Functions</a><a class="headerlink" href="#testing-new-functions" title="Permalink to this headline">¶</a></h2>
<p>We describe here how to use <a class="reference internal" href="fgeneric.html#module-fgeneric" title="fgeneric"><code class="xref py py-mod docutils literal"><span class="pre">fgeneric</span></code></a> to record experiments on functions
that are not part of the BBOB testbeds.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This feature is only available in Python for the moment.</p>
</div>
<p>Example: log experiment using the Nelder-Mead simplex algorithm
(<code class="xref py py-meth docutils literal"><span class="pre">scipy.optimize.fmin</span></code>) on the sphere function.
The following commands from the Python Interpreter does 15 runs of the
Nelder-Mead simplex algorithm on the 2-D sphere functions. The data is recorded
in folder <code class="file docutils literal"><span class="pre">data</span></code> in the current working directory.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fgeneric</span> <span class="kn">as</span> <span class="nn">fg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="kn">as</span> <span class="nn">so</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">)</span> <span class="c"># function definition</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">LoggingFunction</span><span class="p">(</span><span class="n">datapath</span><span class="o">=</span><span class="s">&#39;data&#39;</span><span class="p">,</span> <span class="n">algid</span><span class="o">=</span><span class="s">&#39;Nelder-Mead simplex&#39;</span><span class="p">,</span>
<span class="go">                  comments=&#39;x0 uniformly sampled in [0, 1]^2, &#39;</span>
<span class="go">                           &#39;default settings&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span> <span class="c"># 15 repetitions</span>
<span class="gp">... </span>    <span class="n">e</span><span class="o">.</span><span class="n">setfun</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">fopt</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">funId</span><span class="o">=</span><span class="s">&#39;sphere&#39;</span><span class="p">,</span> <span class="n">iinstance</span><span class="o">=</span><span class="s">&#39;0&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">so</span><span class="o">.</span><span class="n">fmin</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">evalfun</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c"># algorithm call</span>
<span class="gp">... </span>    <span class="n">e</span><span class="o">.</span><span class="n">finalizerun</span><span class="p">()</span>
<span class="go">(&lt;bound method LoggingFunction.evalfun of &lt;fgeneric.LoggingFunction object at [...]&gt;&gt;, 1e-08)</span>
<span class="go">Optimization terminated successfully.</span>
<span class="go">         Current function value: 0.000000</span>
<span class="go">         Iterations: [...]</span>
<span class="go">         Function evaluations: [...]</span>
<span class="go">array([...])</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Display convergence graphs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">bbob_pproc</span> <span class="kn">as</span> <span class="nn">bb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//runningexp-1.py">Source code</a>, <a class="reference external" href=".//runningexp-1.png">png</a>, <a class="reference external" href=".//runningexp-1.hires.png">hires.png</a>, <a class="reference external" href=".//runningexp-1.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/runningexp-1.png" src="_images/runningexp-1.png" />
</div>
<div class="section" id="testing-functions-with-parameter">
<h3><a class="toc-backref" href="#id11">Testing Functions with Parameter</a><a class="headerlink" href="#testing-functions-with-parameter" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This feature is only available in Python for the moment.</p>
</div>
<p>Example: log experiment using the BFGS algorithm
(<code class="xref py py-meth docutils literal"><span class="pre">scipy.optimize.fmin</span></code>) on the ellipsoid function with different
condition numbers.</p>
<p>The following commands from the Python Interpreter does 15 runs of the
BFGS algorithm on the 2-D sphere functions. The data is recorded
in folder <code class="file docutils literal"><span class="pre">data</span></code> in the current working directory and generate</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fgeneric</span> <span class="kn">as</span> <span class="nn">fg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="kn">as</span> <span class="nn">so</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">LoggingFunction</span><span class="p">(</span><span class="n">datapath</span><span class="o">=</span><span class="s">&#39;ellipsoid&#39;</span><span class="p">,</span> <span class="n">algid</span><span class="o">=</span><span class="s">&#39;BFGS&#39;</span><span class="p">,</span>
<span class="go">                  comments=&#39;x0 uniformly sampled in [0, 1]^5, default settings&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cond_num</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cond_num</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">c</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c"># function definition: these are term-by-term operations</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span> <span class="c"># 5 repetitions</span>
<span class="gp">... </span>        <span class="n">e</span><span class="o">.</span><span class="n">setfun</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">fopt</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">funId</span><span class="o">=</span><span class="s">&#39;ellipsoid&#39;</span><span class="p">,</span> <span class="n">iinstance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">condnum</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">so</span><span class="o">.</span><span class="n">fmin_bfgs</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">evalfun</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c"># algorithm call</span>
<span class="gp">... </span>        <span class="n">e</span><span class="o">.</span><span class="n">finalizerun</span><span class="p">()</span>
<span class="go">(&lt;bound method LoggingFunction.evalfun of &lt;fgeneric.LoggingFunction object at [...]&gt;&gt;, 1e-08)</span>
<span class="go">Optimization terminated successfully.</span>
<span class="go">         Current function value: 0.000000</span>
<span class="go">         Iterations: [...]</span>
<span class="go">         Function evaluations: [...]</span>
<span class="go">         Gradient evaluations: [...]</span>
<span class="go">array([...])</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># plot data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">bbob_pproc</span> <span class="kn">as</span> <span class="nn">bb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">bbob_pproc.ppfigparam</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;ellipsoid&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bb</span><span class="o">.</span><span class="n">ppfigparam</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="s">&#39;condnum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bb</span><span class="o">.</span><span class="n">ppfigparam</span><span class="o">.</span><span class="n">beautify</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Condition Number&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./pyplots/varcond.py">Source code</a>, <a class="reference external" href="./pyplots/varcond.png">png</a>, <a class="reference external" href="./pyplots/varcond.hires.png">hires.png</a>, <a class="reference external" href="./pyplots/varcond.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/varcond.png" src="_images/varcond.png" />
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Running Experiments with COCO</a><ul>
<li><a class="reference internal" href="#exampleexperiment-and-exampletiming"><code class="file docutils literal"><span class="pre">exampleexperiment</span></code> and <code class="file docutils literal"><span class="pre">exampletiming</span></code></a><ul>
<li><a class="reference internal" href="#matlab-gnu-octave">Matlab/GNU Octave</a></li>
<li><a class="reference internal" href="#c-c">C/C++</a></li>
<li><a class="reference internal" href="#r">R</a><ul>
<li><a class="reference internal" href="#quick-installation">Quick Installation</a></li>
<li><a class="reference internal" href="#detailed-installation">Detailed Installation</a></li>
<li><a class="reference internal" href="#simple-experiment">Simple experiment</a></li>
<li><a class="reference internal" href="#low-level-interface">Low-level interface</a></li>
</ul>
</li>
<li><a class="reference internal" href="#python">Python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#testing-new-functions">Testing New Functions</a><ul>
<li><a class="reference internal" href="#testing-functions-with-parameter">Testing Functions with Parameter</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="bbo_experiment.html"
                        title="previous chapter">Black-Box Optimization Benchmarking Procedure</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="postprocessing.html"
                        title="next chapter">Post-Processing with COCO</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/runningexp.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="postprocessing.html" title="Post-Processing with COCO"
             >next</a> |</li>
        <li class="right" >
          <a href="bbo_experiment.html" title="Black-Box Optimization Benchmarking Procedure"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">COCO 15.03
 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2011, Finck, Hansen, Ros, Auger.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>